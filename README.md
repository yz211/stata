# 政务服务满意度分析系统

这是一个基于 Python Streamlit 开发的交互式数据分析工具，旨在复现 Stata 脚本中的两阶段残差回归分析流程。

## 功能特点

1.  **数据上传**: 支持 `.dta` (Stata), `.csv`, `.xlsx` 格式文件。
2.  **第一阶段回归**:
    *   自定义因变量、控制变量和固定效应。
    *   自动提取残差。
3.  **残差诊断**:
    *   Q-Q 图与直方图可视化。
    *   3σ 原则自动检测并标记极端值。
4.  **第二阶段回归**:
    *   支持选择交互变量（如：服务人员性别 x 公众性别）。
    *   可选是否剔除极端值。
    *   自动生成交互项回归结果。
5.  **可视化与导出**:
    *   生成交互效应图 (类似 Stata 的 `marginsplot`)。
    *   支持导出回归结果 (HTML) 和绘图数据 (CSV)。

## 安装与运行

### 1. 安装依赖

请确保已安装 Python 3.8+。在终端中运行以下命令安装所需库：

```bash
pip install -r requirements.txt
```

### 2. 运行应用

在终端中运行：

```bash
streamlit run app.py
```

运行成功后，浏览器将自动打开分析界面（通常为 http://localhost:8501）。

## 使用说明

1.  **左侧边栏**: 上传你的数据文件。
2.  **配置变量**:
    *   选择 **因变量** (Y)。
    *   选择 **控制变量** 和 **固定效应** 用于第一阶段回归。
    *   选择两个 **交互变量** 用于第二阶段分析。
3.  **按步骤操作**:
    *   点击 "运行第一阶段回归"。
    *   查看残差诊断结果，决定是否剔除极端值。
    *   点击 "运行第二阶段回归" 查看最终结果和交互图。
